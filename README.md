# CVE-2022-26809
this is not an exploit or a poc


For someone familiar with RPC using bindiff is enough to make an exploit

Constructing a poc is not complicated

And it is not complicated to construct the exploit from the poc

## CVE-2022-26809 has nothing to do with SMB, it's an RPC vuln where a variety of transports can be used, like TCP/135, SMB/445, etc.

# so do the patch now！！

# some src part 1
```c++
/*++
Function Name:GetCoalescedBuffer
Parameters:
    Message - the message structure that will receive the params
Description:
    This routine will coalesce the buffers in the buffer queue into a single
    buffer and return it in the Message structure. If the RPC_BUFFER_EXTRA
    flag is set, the data is appended to the existing buffer in Message->Buffer.
Returns:
    RPC_S_OK - the function was successful in doing its job
    RPC_S_OUT_OF_MEMORY - ran out of memory.
--*/
RPC_STATUS
OSF_SCALL::GetCoalescedBuffer (
    IN PRPC_MESSAGE Message,
    BOOL fForceExtra
    );
/*++
Function Name:ProcessResponse
Parameters:
Description:
    Process the response data. The first buffer is placed on the buffer queue
    only after alloc_hint bytes have been received.
Returns:
--*/
RPC_STATUS
OSF_CCALL::ProcessResponse (
    IN rpcconn_response *Packet,
    IN PRPC_MESSAGE Message,
    OUT BOOL *pfSubmitReceive
    );
```


# to be continued
